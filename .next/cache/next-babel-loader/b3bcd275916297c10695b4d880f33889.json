{"ast":null,"code":"import { db } from './db';\nimport { distance } from './geo';\nexport const getCurrentDate = () => {\n  const today = new myds.getTimeDate();\n};\nexport const checkExists = async user => {\n  const today = new Date();\n  const currentDate = today.getFullYear() + '-' + today.getMonth() + '-' + today.getDate(); //this operation\"db\" is a promise\n\n  const todaysCheckin = await db.collection('markers').doc(currentDate).collection('checks').doc(user).get();\n  const todaysData = todaysCheckin.data();\n  return todaysData;\n}; //export default checkExists\n\nexport const findChecksNearbyCheckin = async checkin => {\n  const today = new Date();\n  const currentDate = today.getFullYear() + '-' + today.getMonth() + '-' + today.getDate();\n  const checkins = await db.collection('markers').doc(currentDate).collection('checks').near({\n    center: checkin.coordinates,\n    radius: 1000\n  }).get();\n  const checkinsList = [];\n  checkins.docs.forEach(doc => {\n    checkinsList.push({\n      //...doc.data(),\n      id: doc.id,\n      status: doc.data().status,\n      coords: {\n        lat: doc.data().coordinates.latitude,\n        long: doc.data().coordinates.longitude\n      },\n      distance: distance(checkin.coordinates.latitude, checkin.coordinates.longitude, doc.data().coordinates.latitude, doc.data().coordinates.longitude).toFixed(2)\n    });\n  });\n  return checkinsList;\n};\nexport const setStatus = async (user, dados) => {\n  const today = new Date();\n  const currentDate = today.getFullYear() + '-' + today.getMonth() + '-' + today.getDate();\n  await db.collection('markers').doc(currentDate).collection('checks').doc(user).set({\n    status: dados.status,\n    user: user,\n    coordinates: new admin.firestore.GeoPoint(dados.coords.lat, dados.coords.long)\n  });\n};","map":{"version":3,"sources":["C:/mydailystatus/lib/markers.js"],"names":["db","distance","getCurrentDate","today","myds","getTimeDate","checkExists","user","Date","currentDate","getFullYear","getMonth","getDate","todaysCheckin","collection","doc","get","todaysData","data","findChecksNearbyCheckin","checkin","checkins","near","center","coordinates","radius","checkinsList","docs","forEach","push","id","status","coords","lat","latitude","long","longitude","toFixed","setStatus","dados","set","admin","firestore","GeoPoint"],"mappings":"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","sourcesContent":["import {db} from './db'\r\nimport { distance } from './geo'\r\n\r\nexport const getCurrentDate = () => {\r\n    const today = new myds.getTimeDate()\r\n}\r\nexport const checkExists = async(user) => {\r\n    const today = new Date()\r\n            const currentDate = today.getFullYear() + '-' + today.getMonth() + '-' + today.getDate()\r\n            //this operation\"db\" is a promise\r\n            const todaysCheckin = await db\r\n                                        .collection('markers')\r\n                                        .doc(currentDate)\r\n                                        .collection('checks')\r\n                                        .doc(user)\r\n                                        .get()\r\n            const todaysData = todaysCheckin.data()\r\n            return todaysData \r\n}\r\n//export default checkExists\r\nexport const findChecksNearbyCheckin = async checkin => {\r\n    const today = new Date()\r\n    const currentDate = today.getFullYear() + '-' + today.getMonth() + '-' + today.getDate()\r\n    const checkins = await db\r\n                    .collection('markers')\r\n                    .doc(currentDate)\r\n                    .collection('checks')\r\n                    .near({\r\n                        center: checkin.coordinates,\r\n                        radius: 1000\r\n                    })\r\n                    .get()\r\n    const  checkinsList = [] \r\n            \r\n    checkins.docs.forEach(doc => {\r\n        checkinsList.push({\r\n                    //...doc.data(),\r\n            id: doc.id,\r\n            status: doc.data().status,\r\n            coords: {\r\n                lat: doc.data().coordinates.latitude,\r\n                long: doc.data().coordinates.longitude\r\n            },\r\n            distance: distance(\r\n                checkin.coordinates.latitude, \r\n                checkin.coordinates.longitude, \r\n                doc.data().coordinates.latitude, \r\n                doc.data().coordinates.longitude\r\n                ).toFixed(2)\r\n        })\r\n    })\r\n    return checkinsList\r\n}\r\nexport const setStatus = async(user, dados) => {\r\n    const today = new Date()\r\n    const currentDate = today.getFullYear() + '-' + today.getMonth() + '-' + today.getDate()\r\n    await db\r\n           .collection('markers')\r\n           .doc(currentDate)\r\n           .collection('checks')\r\n           .doc(user)\r\n           .set({\r\n               status: dados.status,\r\n               user: user,\r\n               coordinates: new admin.firestore.GeoPoint(\r\n                   dados.coords.lat,\r\n                   dados.coords.long\r\n               )\r\n           })\r\n}"]},"metadata":{},"sourceType":"module"}